<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
  </head>
  <body>
    <h1><%= title %></h1>
    <h2>Tienes las fichas <%= usuario %></h2>
    <table>
      <!-- Si es el jugador 1 -->
      <% if (meToca == 1) { %>
        <!-- Pintamos el tablero desde arriba, mostrando las blancas abajo -->
        <% for (var f = 0; f < 8; f++) { %>
          <tr>
          <% for (var c = 0; c < 8; c++) { %>
            <td>
              <% if (t[f][c] == 0) { %>
                <!-- Si no hay ficha  -->
                <% t += '<td id="' + f + c + '" onclick="procesar(this.id)">'; %>
              <% } else if ( t[f][c].indexOf("N") == 0){ %>
                <!-- Si hay ficha Negra -->
                <% t += '<td id="' + f + c + '" onclick="procesar(this.id)">'; %>
              <% } else { %>
                <!-- Si hay ficha Blanca -->
                <% t += '<td id="' + f + c + '" onclick="procesar(this.id)">'; %>
              <% } %>
            </td> 
          <% } %>
          </tr>
        <% } %>
      <!-- Si es el jugador 2,  -->
      <% } else { %>
        <!-- Pintamos el tablero desde abajo, mostrando las negras abajo -->
        <!-- De esta forma, ambos jugadores verÃ¡n el tablero desde el mismo lado -->
        <% for (var f = 7; f > -1; f--) { %>
          <tr>
            <% for (var c = 0; c < 8; c++) { %>
              <td>
                <% if (t[f][c] == 0) { %>
                  <!-- Si no hay ficha -->
                  <% t += '<td id="' + f + c + '" onclick="procesar(this.id)">'; %>
                <% } else if ( t[f][c].indexOf("B") == 0){ %>
                  <!-- Si hay ficha Blanca -->
                  <% t += '<td id="' + f + c + '" onclick="procesar(this.id)">'; %>
                <% } else { %>
                  <!-- Si hay ficha Negra -->
                  <% t += '<td id="' + f + c + '" onclick="procesar(this.id)">'; %>
                <% } %>
              </td> 
            <% } %>
          </tr>
        <% } %>
      <% } %>
    </table>

    <!-- Comprobar si es el turno de cada jugador -->
    <% if (!meToca) { %>
      <script>
        setInterval(function () {
          fetch('/miturno').then(function(response) {
            if (response.ok) {
              location.reload();
            }
          })
          // Cada tres segundos (3000 ms)
        }, 3000);
      </script>
    <% } %>
  </body>
</html>
